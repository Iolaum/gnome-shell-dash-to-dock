From c77c6031a8a0214a7ef7dbab2ae94de07b5a1eb8 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Marco=20Trevisan=20=28Trevi=C3=B1o=29?= <mail@3v1n0.net>
Date: Fri, 13 Mar 2020 19:42:31 +0100
Subject: [PATCH 20/36] docking: Add mainDock property to DockManager and use
 it

Just nicer than manual index access
---
 docking.js | 12 ++++++++----
 1 file changed, 8 insertions(+), 4 deletions(-)

diff --git a/docking.js b/docking.js
index 015cbca..79f6617 100644
--- a/docking.js
+++ b/docking.js
@@ -1345,7 +1345,7 @@ var KeyboardShortcuts = class DashToDock_KeyboardShortcuts {
                                       Meta.KeyBindingFlags.NONE,
                                       Shell.ActionMode.NORMAL | Shell.ActionMode.OVERVIEW,
                                       () => {
-                                          this._allDocks[0]._activateApp(appNum);
+                                          DockManager.getDefault().mainDock._activateApp(appNum);
                                           this._showOverlay();
                                       });
             }
@@ -1599,6 +1599,10 @@ var DockManager = class DashToDock_DockManager {
         return this._fm1Client;
     }
 
+    get mainDock() {
+        return this._allDocks.length ? this._allDocks[0] : null;
+    }
+
     _ensureFileManagerClient() {
         let supportsLocations = ['show-trash', 'show-mounts'].some((s) => {
             return this._settings.get_boolean(s);
@@ -1729,7 +1733,7 @@ var DockManager = class DashToDock_DockManager {
         Object.defineProperty(Main.overview, 'dash', {
             configurable: true,
             get: () => Main.overview.isDummy ?
-                this._allDocks[0].dash : defaultDashGetter.call(Main.overview),
+                this.mainDock.dash : defaultDashGetter.call(Main.overview),
         });
 
         if (Main.overview.isDummy)
@@ -1760,7 +1764,7 @@ var DockManager = class DashToDock_DockManager {
 
         // Pretend I'm the dash: meant to make appgrid swarm animation come from
         // the right position of the appShowButton.
-        Main.overview._overview._controls.dash = this._allDocks[0].dash;
+        Main.overview._overview._controls.dash = this.mainDock.dash;
     }
 
     _deleteDocks() {
@@ -1843,7 +1847,7 @@ var DockManager = class DashToDock_DockManager {
                             Main.overview.disconnect(overviewShownId);
                             Meta.later_add(Meta.LaterType.BEFORE_REDRAW, () => {
                                 grid.opacity = 255;
-                                grid.animateSpring(IconGrid.AnimationDirection.IN, this._allDocks[0].dash.showAppsButton);
+                                grid.animateSpring(IconGrid.AnimationDirection.IN, this.mainDock.dash.showAppsButton);
                             });
                         });
                     }
-- 
2.25.1

